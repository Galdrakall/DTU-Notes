
## Exercise 1.1

This exercise is in preparation for the second lecture. We start by recapping some notation.

A random variable $X$ on a finite set $V$ is an element of $V$ chosen at random according to a probability distribution  
$D : V \to \mathbb{R}$, i.e. a function such that $D(x) \ge 0$ for all $x \in V$ and

$$
\sum_{x \in V} D(x) = 1.
$$

We write $X \leftarrow D$ to mean “$X$ is sampled according to $D$”.  
If $D$ is the uniform distribution, i.e. $D(x) = \frac{1}{|V|}$ for all $x$, then we also write $X \leftarrow V$.

### a)

Let $X_1, X_2, X_3, X_4 \leftarrow \{1,2,3,4,5,6\}$ be four throws of a fair die. Compute the probability that $X_i = 6$ for at least one $i \in \{1,2,3,4\}$. Write down your calculation using (some of) the notation introduced above.

### Solution a)
$$1 -P(x_1 \neq 6 \cap x_2 \neq 6 \cap x_3 \neq 6 \cap x_4 \neq 6) = 1 - P(x_1 \neq 6)^4 = 1- (\frac{5}{6})^4 $$
### b)

Your friend offers you the following bet:

Before your friend tosses a coin 10 times (denote “heads” by $0$ and “tails” by $1$) you can either:

- try to guess the first 6 coin tosses, or  
- guess a sequence of 7 coin toss results where you think it will be a subsequence of the tosses.

Example:  
If you guessed  
$0,0,1,0,1,1,1$  
and the tosses come up  
$1,0,0,0,1,0,1,1,1,0$,  
you win.

If you win, you get DKK 50; if you lose, you have to pay DKK 1.

Describe a strategy and compute its winning probability. Is your strategy the best strategy? If so, why? Would you take the bet?

### Solution b)

Using the **first option** we get 
$$P(win) = (\frac{1}{6})^6 \rightarrow E[gain] = P(win) \cdot 50 - P(lose) \cdot 1$$
Which gives us
$$\frac{1}{6} \cdot 50 - (1-\frac{1}{26})\cdot 1 = -\frac{13}{64} $$
Which is not optimal as we lose money.

With the **second option** we can set it up such as:
$$ A_1 = 1-7pos$$
$$A_2 = 2-8pos$$
$$A_3 = 3-9 pos$$
$$A_4 = 4-10pos$$
So we have
$$P(win) = P(A_1 \cup A_2 \cup A_3 \cup A_4) $$
$$= \sum_{i=1}^4P(A_i) - \sum_{i <j}P(A_i\cap A_j)+\sum_{i <j<k}P(A_i\cap A_j \cap A_k) - P(win) = P(A_1 \cup A_2 \cup A_3 \cup A_4) $$
The winning chance is maximized when $P(\cap) = 0$, when each guess can only appear once, so:
$$P(win) = \sum_{i=1}^4P(A_i) = 4\cdot \frac{1}{2^7} = \frac{1}{32} \rightarrow E[gain] = \frac{1}{32}\cdot 50 - (1-\frac{1}{32}) \cdot 1 = \frac{19}{32} $$
So you would be much better off going with option 2

---

## Exercise 1.2 — Independence

Here are three joint probability distributions $p_i$, $i = 1,2,3$, on $\{0,1\} \times \{0,1\}$ given as matrices.  
The upper-left entry is $p_i(0,0)$, the upper-right entry is $p_i(0,1)$, etc.

Let $(X_i, Y_i) \leftarrow p_i$ be random variables with joint distribution $p_i$.  
Which of the pairs are independent?

### Distribution $p_1$

$$
p_1 =
\begin{pmatrix}
\frac{1}{2} & 0 \\
0 & \frac{1}{2}
\end{pmatrix}
$$

### Distribution $p_2$

$$
p_2 =
\begin{pmatrix}
\frac{1}{3} & \frac{1}{3} \\
0 & \frac{1}{3}
\end{pmatrix}
$$

### Distribution $p_3$

$$
p_3 =
\begin{pmatrix}
\frac{1}{4} & \frac{1}{4} \\
\frac{1}{4} & \frac{1}{4}
\end{pmatrix}
$$
### Solution
$x_i, y_i$ are independent $\leftrightarrow P(x_i = x, y_i = y) = P(x_i=x)P(y_i = y)$ $\forall x,y \in \{0,1\}$ 
$$
p_1: p_1(0, 0) = \frac{1}{2}, p_1(0, 1) = 0
$$
$$
p_1(1,0) = 0, p_1(1, 1) = \frac{1}{2}
$$
Not independent as $P(X_i=0, Y_i0) = \frac{1}{2} \neq P(X_i=0)P(Y_i=0) = \frac{1}{2} \cdot \frac{1}{2}$
We can then do the same for the rest.

---

## Exercise 1.3 — Generalized Caesar Cipher

We generalize the Caesar cipher as follows. Consider the alphabet

$$
X = \{x_0, \dots, x_{\ell-1}\}
$$

over which plaintext and ciphertext are defined. The key is a uniformly random number

$$
k \in \{0, \dots, \ell-1\}.
$$

The encryption of a string  
$m = x_{i_0} x_{i_1} \dots x_{i_{M-1}}$  
replaces each character $x_i$ by $x_j$ with

$$
j = i + k \mod \ell,
$$

i.e.

$$
e_k(m) = x_{i_0 + k \bmod \ell} \; x_{i_1 + k \bmod \ell} \dots x_{i_{M-1} + k \bmod \ell}.
$$

Decryption is given by

$$
d_k(c) = e_{-k \bmod \ell}(c).
$$

Let  

$$
Y = \{y_0, \dots, y_{127}\}
$$

be the ASCII character table. For example:
- $y_0 = \text{NULL}$
- $y_{65} = \text{A}$
- $y_{49} = 1$

For any $a,b \in \{0,\dots,127\}$ define

$$
X_{a,b} = \{x_0, \dots, x_{b-a}\}, \quad \text{with } x_i = y_{i+a}.
$$

For some $a,b \in \{0,\dots,127\}$ the following ciphertext was generated by encrypting an English plaintext using the Caesar cipher on $X_{a,b}$:
```
;\r6TXfTe~r[bjrTeXrlbhrWb\aZ2rHf\aZrUeb^XarVelcgb~r[h[2r;TccXafrgbrg[X rUXfgrbYrhf!!!rAXkgrg\‘XrTebhaW~rgelr48F $%+r\ar:T_b\fr6bhagXer@bWXsss
```

```
import string

ciphertext = r""";\r6TXfTe~r[bjrTeXrlbhrWb\aZ2rHf\aZrUeb^XarVelcgb~r[h[2r;TccXafrgbrg[X rUXfgrbYrhf!!!rAXkgrg\‘XrTebhaW~rgelr48F $%+r\ar:T_b\fr6bhagXer@bWXsss"""

def decrypt_caesar_ascii(ct, a, b, k):

	ell = b - a + 1
	out = []
	for ch in ct:
		c = ord(ch)
		if a <= c <= b:
			idx = c - a
			out.append(chr(a + (idx - k) % ell))
	
		else:
			out.append(ch) # keep newlines, etc.
	return "".join(out)

  

def english_score(s):
	score = 0
	freq = " etaoinshrdluETAOINSHRDLU"
	for c in freq:
		score += s.count(c)

	printable = set(string.printable)
	score += 10 * sum(c in printable for c in s) / len(s)
	score += 20 * s.count(" ") / len(s)

  return score

results = []

for a in range(32, 127):
	for b in range(a, 127):
	
	# SAFE FILTER: allow a small number of out-of-range chars(newlines)
		bad = 0
		
		for ch in ciphertext:
		
			c = ord(ch)
			if ch != "\n" and not (a <= c <= b):
			bad += 1
		if bad > 2:
		continue
		
		ell = b - a + 1
	
		# Must contain space for English
		
		if not (a <= 32 <= b):
		continue
		
		for k in range(ell):
			pt = decrypt_caesar_ascii(ciphertext, a, b, k)
			sc = english_score(pt)
			results.append((sc, a, b, k, pt))

  

# SORT AND PRINT TOP RESULTS

results.sort(reverse=True)

sc, a, b, k, pt = results[0]
print(f"a = {a}, b = {b}, ℓ = {b-a+1}, key k = {k}")
print(f"Score = {sc:.2f}")
print("Plaintext:\n")
print(pt)
print()
```
